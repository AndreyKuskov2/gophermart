CREATE TABLE IF NOT EXISTS users(
    user_id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    login VARCHAR(64) NOT NULL UNIQUE,
    password VARCHAR(128) NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS orders(
    order_id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    number VARCHAR(64) UNIQUE NOT NULL,
    status VARCHAR(32) NOT NULL,
    accrual FLOAT,
    uploaded_at TIMESTAMP DEFAULT NOW(),
    user_id INTEGER,

    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS withdrawals(
    withdrawal_id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    order_number VARCHAR(64) NOT NULL,
    amount FLOAT NOT NULL,
    processed_at TIMESTAMP DEFAULT NOW(),
    user_id INTEGER,

    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
);